# Localization

You don't have to understand the code to contribute to localization work. However, adding new localization files might cause error if localization files are not standard. If that occurred, send the files to me and I will do troubleshooting.

### Basic

In **data/** directory lies different versions of game files along with localization files. There are 7 official languages by default in each official release. But you can add the other languages from language mods, [detail](#new-version-language)

The language of website itself need to be generated by yourself using python.
You can generate a new language by following steps:
1. Go to the root directory of this project
2. Open terminal
3. Make locale files by language code, [detail](#new-project-language)

### New Version Language

If you want to add other languages, you should get a language mod, unzip it and place the folder contains all the **yml** files into this directory. Of course, there is no limit to the name of that folder, but you need to specify that in the code so choose wisely. Better short and less confusion. **If the mod works in the way to replace one of the official language, you must change all the files in that folder, alter the first line from, for example, l_english to l_japanese.** 

Then go to [parse.py](stellaris_tech_tree/parse.py), find this, and add your new language to the map. The left side is the language code used by django, and the right side should be the one used by you.

```python
locale_name = {'zh_hans': 'chinese_s',
               'zh_hant': 'chinese_t',
               'en_us'  : 'english',
               'de_de'  : 'german',
               'es_es'  : 'spanish',
               'fr_fr'  : 'french',
               'pl'     : 'polish',
               'pt_br'  : 'braz_por',
               'ru'     : 'russian'}
locale_postfix = {'zh_hans': 'l_chinese_s',
                  'zh_hant': 'l_chinese_t',
                  'en_us'  : 'l_english',
                  'de_de'  : 'l_german',
                  'es_es'  : 'l_spanish',
                  'fr_fr'  : 'l_french',
                  'pl'     : 'l_polish',
                  'pt_br'  : 'l_braz_por',
                  'ru'     : 'l_russian'}
```

But it cannot work if there isn't a corresponding UI language. So you need to add that language in the project.

### New Project Language

Add a project language is a little more harder and requires Python environment. But it's still easy to proceed.

First go to the root folder (or you have already done that), and excute`python3 manage.py makemessages -l fr_FR` `python3 manage.py makemessages -d djangojs -l fr_FR`

It might take some time, after the commands are finished, go to **locale/** directory and find the corresponding language code folder. Open **LC_MESSAGES/django.po**, **LC_MESSAGES/djangojs.po** and translate from english.

Then go to [settings.py](stellaris_tech_tree/settings.py), find this, and add the language code and language name you just made. Note that the language code is linked by a minus sign instead of underscores.

```python
LANGUAGES = (
    ('zh-hans', '简体中文'),
    ('zh-hant', '繁體中文'),
    ('en', 'English'),
)
```

Then go to [index.html](templates/index.html), find this, and add or uncomment the language code and language name for the language you just made. There are 2 `<li >`tags that are required to add totally. Note that the language code is linked by a minus sign instead of underscores.

```html
<ul class="menulist">
    <!--<li class="menulistitem" value="de">Deutsch</li>-->
    <li class="menulistitem" value="en" onclick="switchLanguage(this)">English</li>
    <!--<li class="menulistitem" value="es">español</li>-->
    <!--<li class="menulistitem" value="fr">français</li>-->
    <!--<li class="menulistitem" value="pt-br">Português Brasileiro</li>-->
    <!--<li class="menulistitem" value="ru">Русский</li>-->
    <!--<li class="menulistitem" value="ja">日本語</li>-->
    <li class="menulistitem" value="zh-hans" onclick="switchLanguage(this)">简体中文</li>
    <li class="menulistitem" value="zh-hant" onclick="switchLanguage(this)">繁體中文</li>
    <!--<li class="menulistitem" value="ko">한국어</li>-->
</ul>
```

```html
<ul class="nav-list">
    <li class="nav-item nav-item-heading" onclick="switchLanguage(this)">
        <span class="nav-responsive-tab nav-title" id="en">
            <span>English</span>
        </span>
    </li>
    <li class="nav-item nav-item-heading" onclick="switchLanguage(this)">
        <span class="nav-responsive-tab nav-title" id="zh-hans">
            <span>简体中文</span>
        </span>
    </li>
    <li class="nav-item nav-item-heading" onclick="switchLanguage(this)">
        <span class="nav-responsive-tab nav-title" id="zh-hant">
            <span>繁體中文</span>
        </span>
    </li>
</ul>
```

**NOTICE:** You need to compile languages after translatiion by excuting `python3 manage.py compilemessages`, and restart django after compiling.

Thank you for contributing to this project, you can help making it much more awesome.